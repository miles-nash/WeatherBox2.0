#include <ESP8266WiFi.h>
#include <WiFiClient.h> 
WiFiClient client;
//User Settings
////////////////////
const char WIFI_SSID []    = "----------";//name of Wifi network
const char WIFI_PASSWORD [] = "----------";
const String CITY = "----------"; //name of city
const String COUNTRY = "--"; //2 digit country code (ISO 3166)
const String APIKEY = "--------------------------------"; //API Key from Open Weather Map
////////////////////
const String LOCATION = CITY + "," + COUNTRY;

void setup() {
  
  Serial.begin(115200);
  delay(500);
  connectWifi();
  
}

void loop() {
  // put your main code here, to run repeatedly:
  Serial.print("We did it bois");
  getWeather();
  delay(1000);
}

void connectWifi() {
  WiFi.begin(WIFI_SSID, WIFI_PASSWORD);
  Serial.print("Connecting to ");
  Serial.println(WIFI_SSID);
  while (WiFi.status() != WL_CONNECTED) {
    delay(500);
    Serial.print(".");
  }
  Serial.println("");
  Serial.println("WiFi connected!");
  Serial.println(WiFi.localIP());
  Serial.println();
}

void getWeather(){
 Serial.println("\nStarting connection to server..."); 
 // if you get a connection, report back via serial: 
 if (client.connect("api.openweathermap.org", 80)) { 
   Serial.println("connected to server"); 
   // Make a HTTP request: 
   client.print("GET /data/2.5/forecast?"); 
   client.print("q="+LOCATION); 
   client.print("&appid="+APIKEY); 
   client.print("&cnt=3"); 
   client.println("&units=metric"); 
   client.println("Host: api.openweathermap.org"); 
   client.println("Connection: close"); 
   client.println(); 
 } else { 
   Serial.println("unable to connect"); 
 } 
 delay(1000); 
 String line = ""; 
 while (client.connected()) { 
   line = client.readStringUntil('\n'); 
   Serial.println(line); 
 } 
} 
